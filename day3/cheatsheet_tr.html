<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gun 3 Kopya Kagidi - Veritabani Tasarimi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/style.css">
    <style>
        .cheatsheet-card {
            background: #ffffff; border: 1px solid #dee2e6; border-radius: 8px;
            margin-bottom: 1rem; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .cheatsheet-card h5 {
            color: #0b132b; border-bottom: 2px solid #4dd0e1;
            padding-bottom: 0.5rem; margin-bottom: 1rem;
        }
        .section-title {
            color: #0b132b; font-size: 1.5rem; margin: 2rem 0 1rem;
            border-left: 4px solid #4dd0e1; padding-left: 1rem;
        }
        .keyword { color: #ff7b72; }
        .function { color: #d2a8ff; }
        .string { color: #a5d6ff; }
        .comment { color: #8b949e; }
        .tip {
            background: #e8f5e9; border-left: 4px solid #4caf50; padding: 0.75rem 1rem;
            margin: 0.5rem 0; border-radius: 0 5px 5px 0;
        }
        .warning {
            background: #fff3e0; border-left: 4px solid #ff9800; padding: 0.75rem 1rem;
            margin: 0.5rem 0; border-radius: 0 5px 5px 0;
        }
        .quick-ref { background: #e3f2fd; border: 1px solid #1e88e5; border-radius: 8px; padding: 1rem; }
        .quick-ref h5 { color: #1e88e5; border-bottom: none; }
        .nf-badge {
            display: inline-block; padding: 0.3rem 0.6rem; border-radius: 20px;
            font-weight: bold; margin: 2px; color: white;
        }
        .nf-1 { background: #e91e63; }
        .nf-2 { background: #9c27b0; }
        .nf-3 { background: #673ab7; }
        .nf-bcnf { background: #3f51b5; }
    </style>
</head>
<body>
    <a href="../index.html" class="back-button">← Anasayfaya Don</a>
    <div class="language-switcher">
        <a href="cheatsheet.html">EN</a>
        <a href="cheatsheet_tr.html" class="active">TR</a>
    </div>
    <div id="europeanunion-turkey">
        <img src="../static/eu.png" alt="">
    </div>
    <div id="sanayiteknolojibakan">
        <img src="../static/sanayitek.png" alt="">
    </div>
    <div id="rekabet">
        <img src="../static/rekabet.png" alt="">
    </div>
    <div id="tisk">
        <img src="../static/tisk.png" alt="">
    </div>
    <div id="undp">
        <img src="../static/undp.png" alt="">
    </div>

    <div class="content-container">
        <div class="container">
            <section>
                <h1>Gun 3: Veritabani Tasarimi</h1>
                <p class="text-muted">Normalizasyon, Sema Yonetimi & Eklentiler</p>

        <!-- Hizli Referans -->
        <div class="quick-ref mb-4">
            <h5 class="text-center mb-3">Normal Formlar Hizli Referans</h5>
            <div class="row text-center">
                <div class="col-md-3"><span class="nf-badge nf-1">1NF</span> Atomik degerler, tekrarlayan grup yok</div>
                <div class="col-md-3"><span class="nf-badge nf-2">2NF</span> 1NF + Kismi bagimlilik yok</div>
                <div class="col-md-3"><span class="nf-badge nf-3">3NF</span> 2NF + Gecisken bagimlilik yok</div>
                <div class="col-md-3"><span class="nf-badge nf-bcnf">BCNF</span> 3NF + Her belirleyici bir anahtar</div>
            </div>
        </div>

        <!-- Normalizasyon -->
        <h3 class="section-title">Veritabani Normalizasyonu</h3>

        <div class="cheatsheet-card p-3">
            <h5>Birinci Normal Form (1NF)</h5>
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Kurallar:</strong></p>
                    <ul>
                        <li>Her sutun atomik (bolunmez) degerler icerir</li>
                        <li>Her sutun tek tip deger icerir</li>
                        <li>Her satir benzersizdir (primary key var)</li>
                        <li>Tekrarlayan grup veya dizi yok</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <pre><code><span class="comment">-- 1NF'yi ihlal eder (birden fazla telefon)</span>
| id | name | phones              |
| 1  | John | 555-1234, 555-5678  |

<span class="comment">-- 1NF Uyumlu</span>
| id | name | phone    |
| 1  | John | 555-1234 |
| 1  | John | 555-5678 |

<span class="comment">-- Veya ayri tablo</span>
user_phones(user_id, phone)</code></pre>
                </div>
            </div>
        </div>

        <div class="cheatsheet-card p-3">
            <h5>Ikinci Normal Form (2NF)</h5>
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Kurallar:</strong></p>
                    <ul>
                        <li>1NF'de olmali</li>
                        <li>Kismi bagimlilik yok</li>
                        <li>Anahtar olmayan sutunlar TUM primary key'e bagimli</li>
                        <li>Sadece birlesik primary key'lere uygulanir</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <pre><code><span class="comment">-- 2NF'yi ihlal eder (product_name sadece product_id'ye bagimli)</span>
order_items(order_id, product_id, product_name, qty)

<span class="comment">-- 2NF Uyumlu</span>
order_items(order_id, product_id, qty)
products(product_id, product_name)</code></pre>
                </div>
            </div>
        </div>

        <div class="cheatsheet-card p-3">
            <h5>Ucuncu Normal Form (3NF)</h5>
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Kurallar:</strong></p>
                    <ul>
                        <li>2NF'de olmali</li>
                        <li>Gecisken bagimlilik yok</li>
                        <li>Anahtar olmayan sutunlar SADECE primary key'e bagimli</li>
                        <li>Diger anahtar olmayan sutunlara bagimli degil</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <pre><code><span class="comment">-- 3NF'yi ihlal eder (city zip'e bagimli, id'ye degil)</span>
employees(id, name, zip, city, state)

<span class="comment">-- 3NF Uyumlu</span>
employees(id, name, zip)
zip_codes(zip, city, state)</code></pre>
                </div>
            </div>
        </div>

        <div class="cheatsheet-card p-3">
            <h5>Denormalizasyon (Kurallari Ne Zaman Ihlal Etmeli)</h5>
            <table>
                <thead><tr><th>Durum</th><th>Neden</th></tr></thead>
                <tbody>
                    <tr><td>Okuma agirlikli is yukleri</td><td>Daha hizli sorgular icin JOIN'leri azalt</td></tr>
                    <tr><td>Raporlama/Analitik</td><td>Onceden hesaplanmis toplamlar</td></tr>
                    <tr><td>Onbellekleme</td><td>Hesaplanmis degerleri sakla</td></tr>
                    <tr><td>Tarihsel veri</td><td>Zaman noktasi degerlerinin anlik goruntusu</td></tr>
                </tbody>
            </table>
            <div class="warning">Denormalizasyon, okuma performansi icin depolama ve guncelleme karmasikligini takas eder.</div>
        </div>

        <!-- Iliskiler -->
        <h3 class="section-title">Varlik Iliskileri</h3>

        <div class="cheatsheet-card p-3">
            <h5>Iliski Turleri</h5>
            <table>
                <thead><tr><th>Tur</th><th>Aciklama</th><th>Uygulama</th></tr></thead>
                <tbody>
                    <tr>
                        <td><strong>Bire-Bir (1:1)</strong></td>
                        <td>A'daki bir kayit B'deki bir kayitla iliskili</td>
                        <td>UNIQUE kisitlamali FK veya ayni PK</td>
                    </tr>
                    <tr>
                        <td><strong>Bire-Cok (1:N)</strong></td>
                        <td>A'daki bir kayit B'deki cok sayida kayitla iliskili</td>
                        <td>"Cok" tablosunda FK</td>
                    </tr>
                    <tr>
                        <td><strong>Coka-Cok (M:N)</strong></td>
                        <td>A'daki cok kayit B'deki cok kayitla iliskili</td>
                        <td>Iki FK'li ara/kopru tablo</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="cheatsheet-card p-3">
                    <h5>Bire-Cok Ornegi</h5>
                    <pre><code><span class="keyword">CREATE TABLE</span> departments (
    id SERIAL <span class="keyword">PRIMARY KEY</span>,
    name VARCHAR(100) <span class="keyword">NOT NULL</span>
);

<span class="keyword">CREATE TABLE</span> employees (
    id SERIAL <span class="keyword">PRIMARY KEY</span>,
    name VARCHAR(100),
    department_id INT <span class="keyword">REFERENCES</span>
        departments(id)
);</code></pre>
                </div>
            </div>
            <div class="col-md-6">
                <div class="cheatsheet-card p-3">
                    <h5>Coka-Cok Ornegi</h5>
                    <pre><code><span class="keyword">CREATE TABLE</span> students (
    id SERIAL <span class="keyword">PRIMARY KEY</span>,
    name VARCHAR(100)
);
<span class="keyword">CREATE TABLE</span> courses (
    id SERIAL <span class="keyword">PRIMARY KEY</span>,
    title VARCHAR(100)
);
<span class="comment">-- Ara tablo</span>
<span class="keyword">CREATE TABLE</span> enrollments (
    student_id INT <span class="keyword">REFERENCES</span> students(id),
    course_id INT <span class="keyword">REFERENCES</span> courses(id),
    <span class="keyword">PRIMARY KEY</span> (student_id, course_id)
);</code></pre>
                </div>
            </div>
        </div>

        <!-- Kisitlamalar -->
        <h3 class="section-title">Kisitlamalar</h3>

        <div class="cheatsheet-card p-3">
            <h5>Kisitlama Turleri</h5>
            <pre><code><span class="keyword">CREATE TABLE</span> products (
    <span class="comment">-- Primary Key</span>
    id SERIAL <span class="keyword">PRIMARY KEY</span>,

    <span class="comment">-- Not Null</span>
    name VARCHAR(100) <span class="keyword">NOT NULL</span>,

    <span class="comment">-- Unique</span>
    sku VARCHAR(50) <span class="keyword">UNIQUE</span>,

    <span class="comment">-- Check kisitlamasi</span>
    price DECIMAL(10,2) <span class="keyword">CHECK</span> (price >= 0),

    <span class="comment">-- Foreign Key</span>
    category_id INT <span class="keyword">REFERENCES</span> categories(id),

    <span class="comment">-- Varsayilan deger</span>
    created_at TIMESTAMPTZ <span class="keyword">DEFAULT NOW</span>(),
    status VARCHAR(20) <span class="keyword">DEFAULT</span> <span class="string">'active'</span>,

    <span class="comment">-- Adlandirilmis kisitlamalar</span>
    <span class="keyword">CONSTRAINT</span> positive_stock <span class="keyword">CHECK</span> (stock >= 0),
    <span class="keyword">CONSTRAINT</span> valid_status <span class="keyword">CHECK</span> (status <span class="keyword">IN</span> (<span class="string">'active'</span>, <span class="string">'inactive'</span>, <span class="string">'discontinued'</span>))
);</code></pre>
        </div>

        <div class="cheatsheet-card p-3">
            <h5>Foreign Key Eylemleri</h5>
            <pre><code><span class="keyword">CREATE TABLE</span> orders (
    id SERIAL <span class="keyword">PRIMARY KEY</span>,
    customer_id INT <span class="keyword">REFERENCES</span> customers(id)
        <span class="keyword">ON DELETE SET NULL</span>     <span class="comment">-- Ust silindiginde NULL yap</span>
        <span class="keyword">ON UPDATE CASCADE</span>      <span class="comment">-- Ust ID degistiginde guncelle</span>
);

<span class="comment">-- ON DELETE secenekleri:</span>
<span class="keyword">CASCADE</span>      <span class="comment">-- Alt satirlari da sil</span>
<span class="keyword">SET NULL</span>     <span class="comment">-- FK'yi NULL yap</span>
<span class="keyword">SET DEFAULT</span>  <span class="comment">-- FK'yi varsayilana ayarla</span>
<span class="keyword">RESTRICT</span>     <span class="comment">-- Silmeyi engelle (varsayilan)</span>
<span class="keyword">NO ACTION</span>    <span class="comment">-- RESTRICT gibi ama ertelenmis</span></code></pre>
        </div>

        <!-- Sema Yonetimi -->
        <h3 class="section-title">Sema Yonetimi</h3>

        <div class="row">
            <div class="col-md-6">
                <div class="cheatsheet-card p-3">
                    <h5>Sema Komutlari</h5>
                    <pre><code><span class="comment">-- Sema olustur</span>
<span class="keyword">CREATE SCHEMA</span> sales;

<span class="comment">-- Semada tablo olustur</span>
<span class="keyword">CREATE TABLE</span> sales.orders (...);

<span class="comment">-- Arama yolunu ayarla</span>
<span class="keyword">SET</span> search_path <span class="keyword">TO</span> sales, public;

<span class="comment">-- Mevcut semayi goster</span>
<span class="keyword">SELECT</span> current_schema();

<span class="comment">-- Semayi sil</span>
<span class="keyword">DROP SCHEMA</span> sales;
<span class="keyword">DROP SCHEMA</span> sales <span class="keyword">CASCADE</span>;</code></pre>
                </div>
            </div>
            <div class="col-md-6">
                <div class="cheatsheet-card p-3">
                    <h5>Isimlendirme Kurallari</h5>
                    <table>
                        <tbody>
                            <tr><td>Tablolar</td><td><code>snake_case</code>, cogul</td><td><code>user_accounts</code></td></tr>
                            <tr><td>Sutunlar</td><td><code>snake_case</code></td><td><code>first_name</code></td></tr>
                            <tr><td>Primary Key</td><td><code>id</code> veya <code>table_id</code></td><td><code>id</code></td></tr>
                            <tr><td>Foreign Key</td><td><code>referans_edilen_tablo_id</code></td><td><code>department_id</code></td></tr>
                            <tr><td>Index'ler</td><td><code>idx_tablo_sutunlar</code></td><td><code>idx_users_email</code></td></tr>
                            <tr><td>Kisitlamalar</td><td><code>tur_tablo_sutun</code></td><td><code>pk_users</code></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ALTER TABLE -->
        <h3 class="section-title">Tablolari Degistirme</h3>

        <div class="cheatsheet-card p-3">
            <h5>ALTER TABLE Komutlari</h5>
            <pre><code><span class="comment">-- Sutun ekle</span>
<span class="keyword">ALTER TABLE</span> users <span class="keyword">ADD COLUMN</span> phone VARCHAR(20);

<span class="comment">-- Sutun sil</span>
<span class="keyword">ALTER TABLE</span> users <span class="keyword">DROP COLUMN</span> phone;

<span class="comment">-- Sutunu yeniden adlandir</span>
<span class="keyword">ALTER TABLE</span> users <span class="keyword">RENAME COLUMN</span> phone <span class="keyword">TO</span> phone_number;

<span class="comment">-- Veri tipini degistir</span>
<span class="keyword">ALTER TABLE</span> users <span class="keyword">ALTER COLUMN</span> age <span class="keyword">TYPE</span> SMALLINT;

<span class="comment">-- Kisitlama ekle</span>
<span class="keyword">ALTER TABLE</span> users <span class="keyword">ADD CONSTRAINT</span> email_unique <span class="keyword">UNIQUE</span> (email);

<span class="comment">-- Kisitlama sil</span>
<span class="keyword">ALTER TABLE</span> users <span class="keyword">DROP CONSTRAINT</span> email_unique;

<span class="comment">-- NOT NULL ayarla/kaldir</span>
<span class="keyword">ALTER TABLE</span> users <span class="keyword">ALTER COLUMN</span> email <span class="keyword">SET NOT NULL</span>;
<span class="keyword">ALTER TABLE</span> users <span class="keyword">ALTER COLUMN</span> email <span class="keyword">DROP NOT NULL</span>;

<span class="comment">-- Varsayilan ayarla</span>
<span class="keyword">ALTER TABLE</span> users <span class="keyword">ALTER COLUMN</span> status <span class="keyword">SET DEFAULT</span> <span class="string">'active'</span>;

<span class="comment">-- Tabloyu yeniden adlandir</span>
<span class="keyword">ALTER TABLE</span> users <span class="keyword">RENAME TO</span> user_accounts;</code></pre>
        </div>

        <!-- PostgreSQL Eklentileri -->
        <h3 class="section-title">PostgreSQL Eklentileri</h3>

        <div class="cheatsheet-card p-3">
            <h5>Eklentileri Yonetme</h5>
            <pre><code><span class="comment">-- Mevcut eklentileri listele</span>
<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pg_available_extensions;

<span class="comment">-- Eklenti yukle</span>
<span class="keyword">CREATE EXTENSION IF NOT EXISTS</span> <span class="string">"uuid-ossp"</span>;

<span class="comment">-- Yuklu eklentileri listele</span>
<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pg_extension;

<span class="comment">-- Eklentiyi kaldir</span>
<span class="keyword">DROP EXTENSION</span> <span class="string">"uuid-ossp"</span>;</code></pre>
        </div>

        <div class="cheatsheet-card p-3">
            <h5>Populer PostgreSQL Eklentileri</h5>
            <table>
                <thead><tr><th>Eklenti</th><th>Amac</th><th>Ornek</th></tr></thead>
                <tbody>
                    <tr><td><code>uuid-ossp</code></td><td>UUID uretimi</td><td><code>uuid_generate_v4()</code></td></tr>
                    <tr><td><code>pgcrypto</code></td><td>Sifreleme fonksiyonlari</td><td><code>gen_random_uuid()</code>, sifre hashleme</td></tr>
                    <tr><td><code>pg_trgm</code></td><td>Bulanik metin eslestirme</td><td>Benzerlik araması, yazım hatası toleransı</td></tr>
                    <tr><td><code>PostGIS</code></td><td>Cografi veri</td><td>Konum sorgulari, haritalama</td></tr>
                    <tr><td><code>hstore</code></td><td>Anahtar-deger depolama</td><td>Sutunda basit KV ciftleri</td></tr>
                    <tr><td><code>citext</code></td><td>Buyuk/kucuk harf duyarsiz metin</td><td>Email sutunlari</td></tr>
                </tbody>
            </table>
        </div>

        <!-- View'lar -->
        <h3 class="section-title">View'lar</h3>

        <div class="row">
            <div class="col-md-6">
                <div class="cheatsheet-card p-3">
                    <h5>Normal View'lar</h5>
                    <pre><code><span class="comment">-- View olustur</span>
<span class="keyword">CREATE VIEW</span> active_employees <span class="keyword">AS</span>
<span class="keyword">SELECT</span> e.id, e.name, d.name <span class="keyword">AS</span> dept
<span class="keyword">FROM</span> employees e
<span class="keyword">JOIN</span> departments d <span class="keyword">ON</span> e.dept_id = d.id
<span class="keyword">WHERE</span> e.status = <span class="string">'active'</span>;

<span class="comment">-- View'u degistir</span>
<span class="keyword">CREATE OR REPLACE VIEW</span> active_employees
<span class="keyword">AS</span> ...;

<span class="comment">-- View'u sil</span>
<span class="keyword">DROP VIEW</span> active_employees;</code></pre>
                </div>
            </div>
            <div class="col-md-6">
                <div class="cheatsheet-card p-3">
                    <h5>Materialized View'lar</h5>
                    <pre><code><span class="comment">-- Veriyi fiziksel olarak saklar</span>
<span class="keyword">CREATE MATERIALIZED VIEW</span> mv_sales_summary
<span class="keyword">AS</span>
<span class="keyword">SELECT</span> product_id,
       <span class="function">SUM</span>(amount) <span class="keyword">AS</span> total
<span class="keyword">FROM</span> sales
<span class="keyword">GROUP BY</span> product_id;

<span class="comment">-- Guncellemek icin yenilenmeli</span>
<span class="keyword">REFRESH MATERIALIZED VIEW</span> mv_sales_summary;

<span class="comment">-- Eszamanli yenileme (kilit yok)</span>
<span class="keyword">REFRESH MATERIALIZED VIEW CONCURRENTLY</span>
mv_sales_summary;</code></pre>
                </div>
            </div>
        </div>

        <!-- En Iyi Uygulamalar -->
        <h3 class="section-title">Tasarim En Iyi Uygulamalari</h3>

        <div class="row">
            <div class="col-md-6">
                <div class="tip">
                    <strong>3NF ile baslayin</strong> - Sadece gerekli oldugu kanitlandiginda denormalize edin
                </div>
                <div class="tip">
                    <strong>Uygun veri tiplerini kullanin</strong> - Her sey icin TEXT kullanmayin
                </div>
                <div class="tip">
                    <strong>Kisitlamalar ekleyin</strong> - Veritabaninin veri butunlugunu zorlamasina izin verin
                </div>
                <div class="tip">
                    <strong>Yorumlarla belgeleyin</strong> - <code>COMMENT ON TABLE/COLUMN</code>
                </div>
            </div>
            <div class="col-md-6">
                <div class="warning">
                    <strong>Ayrilmis kelimelerden kacinin</strong> - Sutunlara 'user', 'order', 'table' adini vermeyin
                </div>
                <div class="warning">
                    <strong>Olcek icin planlayin</strong> - Buyume bekleniyorsa ID'ler icin BIGINT kullanin
                </div>
                <div class="warning">
                    <strong>Migrasyonlari test edin</strong> - Sema degisikliklerinden once her zaman yedekleyin
                </div>
                <div class="warning">
                    <strong>Indexleri erken dusunun</strong> - Ama asiri indekslemeyin
                </div>
            </div>
        </div>

            </section>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>
</html>
