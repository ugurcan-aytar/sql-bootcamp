<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="tr" xml:lang="tr">

<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="../style_bootstrap.html">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/code.css">
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Gun 1: Gelismis SELECT Teknikleri - Pratik Ornekler</title>
  <style>
    code {
      white-space: pre-wrap;
    }

    span.smallcaps {
      font-variant: small-caps;
    }

    span.underline {
      text-decoration: underline;
    }

    div.column {
      display: inline-block;
      vertical-align: top;
      width: 50%;
    }

    div.hanging-indent {
      margin-left: 1.5em;
      text-indent: -1.5em;
    }

    ul.task-list {
      list-style: none;
    }

    pre>code.sourceCode {
      white-space: pre;
      position: relative;
    }

    pre>code.sourceCode>span {
      display: inline-block;
      line-height: 1.25;
    }

    pre>code.sourceCode>span:empty {
      height: 1.2em;
    }

    code.sourceCode>span {
      color: inherit;
      text-decoration: inherit;
    }

    div.sourceCode {
      margin: 1em 0;
    }

    pre.sourceCode {
      margin: 0;
    }

    @media screen {
      div.sourceCode {
        overflow: auto;
      }
    }

    @media print {
      pre>code.sourceCode {
        white-space: pre-wrap;
      }

      pre>code.sourceCode>span {
        text-indent: -5em;
        padding-left: 5em;
      }
    }

    pre.numberSource code {
      counter-reset: source-line 0;
    }

    pre.numberSource code>span {
      position: relative;
      left: -4em;
      counter-increment: source-line;
    }

    pre.numberSource code>span>a:first-child::before {
      content: counter(source-line);
      position: relative;
      left: -1em;
      text-align: right;
      vertical-align: baseline;
      border: none;
      display: inline-block;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      padding: 0 4px;
      width: 4em;
      color: #aaaaaa;
    }

    pre.numberSource {
      margin-left: 3em;
      border-left: 1px solid #aaaaaa;
      padding-left: 4px;
    }

    div.sourceCode {}

    @media screen {
      pre>code.sourceCode>span>a:first-child::before {
        text-decoration: underline;
      }
    }

    code span.al {
      color: #ff0000;
      font-weight: bold;
    }

    code span.an {
      color: #60a0b0;
      font-weight: bold;
      font-style: italic;
    }

    code span.at {
      color: #7d9029;
    }

    code span.bn {
      color: #40a070;
    }

    code span.bu {}

    code span.cf {
      color: #007020;
      font-weight: bold;
    }

    code span.ch {
      color: #4070a0;
    }

    code span.cn {
      color: #880000;
    }

    code span.co {
      color: #60a0b0;
      font-style: italic;
    }

    code span.cv {
      color: #60a0b0;
      font-weight: bold;
      font-style: italic;
    }

    code span.do {
      color: #ba2121;
      font-style: italic;
    }

    code span.dt {
      color: #902000;
    }

    code span.dv {
      color: #40a070;
    }

    code span.er {
      color: #ff0000;
      font-weight: bold;
    }

    code span.ex {}

    code span.fl {
      color: #40a070;
    }

    code span.fu {
      color: #06287e;
    }

    code span.im {}

    code span.in {
      color: #60a0b0;
      font-weight: bold;
      font-style: italic;
    }

    code span.kw {
      color: #007020;
      font-weight: bold;
    }

    code span.op {
      color: #666666;
    }

    code span.ot {
      color: #007020;
    }

    code span.pp {
      color: #bc7a00;
    }

    code span.sc {
      color: #4070a0;
    }

    code span.ss {
      color: #bb6688;
    }

    code span.st {
      color: #4070a0;
    }

    code span.va {
      color: #19177c;
    }

    code span.vs {
      color: #4070a0;
    }

    code span.wa {
      color: #60a0b0;
      font-weight: bold;
      font-style: italic;
    }

    .copy-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border-radius: 4px;
      display: none;
      z-index: 1000;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    .exercise-box {
      background-color: #f8f9fa;
      border-left: 4px solid #007bff;
      padding: 15px 20px;
      margin: 20px 0;
      border-radius: 0 8px 8px 0;
    }

    .exercise-box h4 {
      color: #007bff;
      margin-bottom: 10px;
    }

    .challenge-box {
      background-color: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 15px 20px;
      margin: 20px 0;
      border-radius: 0 8px 8px 0;
    }

    .challenge-box h4 {
      color: #856404;
      margin-bottom: 10px;
    }

    .solution-toggle {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      margin-bottom: 10px;
    }

    .solution-toggle:hover {
      background-color: #218838;
    }

    .solution-content {
      display: none;
    }

    .solution-content.show {
      display: block;
    }

    .hint-box {
      background-color: #e7f3ff;
      border: 1px dashed #007bff;
      padding: 10px 15px;
      margin: 10px 0;
      border-radius: 4px;
      font-size: 0.9em;
    }

    .warning-box {
      background-color: #fff3cd;
      border: 1px solid #ffc107;
      padding: 10px 15px;
      margin: 10px 0;
      border-radius: 4px;
      font-size: 0.9em;
    }

    .info-box {
      background-color: #d1ecf1;
      border: 1px solid #17a2b8;
      padding: 10px 15px;
      margin: 10px 0;
      border-radius: 4px;
      font-size: 0.9em;
    }

    .dataset-table {
      margin: 15px 0;
      overflow-x: auto;
    }

    .dataset-table table {
      width: 100%;
      border-collapse: collapse;
    }

    .dataset-table th,
    .dataset-table td {
      border: 1px solid #dee2e6;
      padding: 8px 12px;
      text-align: left;
    }

    .dataset-table th {
      background-color: #e9ecef;
      font-weight: 600;
    }

    .dataset-table tr:nth-child(even) {
      background-color: #f8f9fa;
    }

    .back-link {
      margin-bottom: 20px;
    }

    .back-link a {
      color: #007bff;
      text-decoration: none;
    }

    .back-link a:hover {
      text-decoration: underline;
    }

    .concept-box {
      background-color: #e8f4f8;
      border: 1px solid #17a2b8;
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
    }

    .predict-output {
      background-color: #f0f0f0;
      border: 2px dashed #6c757d;
      padding: 15px;
      margin: 10px 0;
      border-radius: 4px;
    }

    .predict-output h5 {
      color: #6c757d;
      margin-bottom: 10px;
    }

    .comparison-table {
      margin: 15px 0;
    }

    .comparison-table table {
      width: 100%;
      border-collapse: collapse;
    }

    .comparison-table th {
      background-color: #343a40;
      color: white;
      padding: 10px;
    }

    .comparison-table td {
      border: 1px solid #dee2e6;
      padding: 10px;
    }

    .language-switcher {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 1000;
      background: #fff;
      padding: 5px 10px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .language-switcher a {
      text-decoration: none;
      padding: 5px 10px;
      margin: 0 2px;
      border-radius: 3px;
      color: #333;
    }

    .language-switcher a.active {
      background: #0d6efd;
      color: #fff;
    }

    .language-switcher a:hover:not(.active) {
      background: #e9ecef;
    }
  </style>
</head>

<body>
    <a href="../index.html" class="back-button">← Anasayfaya Don</a>
  <div class="language-switcher">
    <a href="05_advanced_select_techniques_examples.html">EN</a>
    <a href="05_advanced_select_techniques_examples_tr.html" class="active">TR</a>
  </div>

  <div class="copy-notification" id="copyNotification">Kopyalandi!</div>

  <div id="europeanunion-turkey">
    <img src="../static/eu.png" alt="">
  </div>
  <div id="sanayiteknolojibakan">
    <img src="../static/sanayitek.png" alt="">
  </div>
  <div id="rekabet">
    <img src="../static/rekabet.png" alt="">
  </div>
  <div id="tisk">
    <img src="../static/tisk.png" alt="">
  </div>
  <div id="undp">
    <img src="../static/undp.png" alt="">
  </div>
  <div class="content-container">
    <div class="container">
      <div class="back-link">
        <a href="05_advanced_select_techniques_tr.html">&larr; Gelismis SELECT Tekniklerine Geri Don</a>
      </div>

      <section>
        <h1 id="advanced-select-examples">Gelismis SELECT Teknikleri - Pratik Ornekler</h1>
        <p>Bu sayfa, toplama fonksiyonlari, GROUP BY, HAVING ve pencere fonksiyonlarini ustalasmak icin uygulamali alistirmalar sunmaktadir.
          Asagidaki ornek veri setleriyle pratik yapin.</p>
      </section>

      <section>
        <h2 id="sample-datasets">Ornek Veri Setleri</h2>

        <h3 id="employees-table">employees</h3>
        <div class="dataset-table">
          <table>
            <thead>
              <tr>
                <th>id</th>
                <th>first_name</th>
                <th>last_name</th>
                <th>department</th>
                <th>salary</th>
                <th>hire_date</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>1</td><td>Alice</td><td>Johnson</td><td>Engineering</td><td>85000</td><td>2020-03-15</td></tr>
              <tr><td>2</td><td>Bob</td><td>Smith</td><td>Engineering</td><td>92000</td><td>2019-06-01</td></tr>
              <tr><td>3</td><td>Carol</td><td>Williams</td><td>Marketing</td><td>65000</td><td>2021-01-10</td></tr>
              <tr><td>4</td><td>David</td><td>Brown</td><td>Engineering</td><td>78000</td><td>2022-04-20</td></tr>
              <tr><td>5</td><td>Eva</td><td>Martinez</td><td>Sales</td><td>72000</td><td>2020-09-05</td></tr>
              <tr><td>6</td><td>Frank</td><td>Garcia</td><td>Marketing</td><td>68000</td><td>2021-07-12</td></tr>
              <tr><td>7</td><td>Grace</td><td>Lee</td><td>Sales</td><td>75000</td><td>2019-11-30</td></tr>
              <tr><td>8</td><td>Henry</td><td>Wilson</td><td>Engineering</td><td>95000</td><td>2018-02-14</td></tr>
              <tr><td>9</td><td>Ivy</td><td>Chen</td><td>Sales</td><td>71000</td><td>2022-08-01</td></tr>
              <tr><td>10</td><td>Jack</td><td>Davis</td><td>Marketing</td><td>62000</td><td>2023-01-15</td></tr>
            </tbody>
          </table>
        </div>

        <h3 id="orders-table">orders</h3>
        <div class="dataset-table">
          <table>
            <thead>
              <tr>
                <th>id</th>
                <th>customer_id</th>
                <th>order_date</th>
                <th>total_amount</th>
                <th>status</th>
                <th>shipped_date</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>1</td><td>101</td><td>2024-01-05</td><td>250.00</td><td>delivered</td><td>2024-01-07</td></tr>
              <tr><td>2</td><td>102</td><td>2024-01-10</td><td>175.50</td><td>delivered</td><td>2024-01-12</td></tr>
              <tr><td>3</td><td>101</td><td>2024-01-15</td><td>320.00</td><td>delivered</td><td>2024-01-18</td></tr>
              <tr><td>4</td><td>103</td><td>2024-02-01</td><td>89.99</td><td>delivered</td><td>2024-02-03</td></tr>
              <tr><td>5</td><td>101</td><td>2024-02-10</td><td>450.00</td><td>delivered</td><td>2024-02-12</td></tr>
              <tr><td>6</td><td>104</td><td>2024-02-15</td><td>125.00</td><td>pending</td><td>NULL</td></tr>
              <tr><td>7</td><td>102</td><td>2024-03-01</td><td>275.50</td><td>delivered</td><td>2024-03-03</td></tr>
              <tr><td>8</td><td>105</td><td>2024-03-10</td><td>599.99</td><td>delivered</td><td>2024-03-12</td></tr>
              <tr><td>9</td><td>103</td><td>2024-03-15</td><td>180.00</td><td>cancelled</td><td>NULL</td></tr>
              <tr><td>10</td><td>101</td><td>2024-03-20</td><td>350.00</td><td>pending</td><td>NULL</td></tr>
            </tbody>
          </table>
        </div>

        <h3 id="sales-data-table">sales_data</h3>
        <div class="dataset-table">
          <table>
            <thead>
              <tr>
                <th>id</th>
                <th>product</th>
                <th>region</th>
                <th>year</th>
                <th>quarter</th>
                <th>month</th>
                <th>sales</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>1</td><td>Smartphone</td><td>North</td><td>2024</td><td>1</td><td>1</td><td>15000.00</td></tr>
              <tr><td>2</td><td>Smartphone</td><td>South</td><td>2024</td><td>1</td><td>2</td><td>12000.00</td></tr>
              <tr><td>3</td><td>Laptop</td><td>North</td><td>2024</td><td>1</td><td>1</td><td>18000.00</td></tr>
              <tr><td>4</td><td>Laptop</td><td>East</td><td>2024</td><td>2</td><td>4</td><td>22000.00</td></tr>
              <tr><td>5</td><td>Tablet</td><td>West</td><td>2024</td><td>2</td><td>5</td><td>8000.00</td></tr>
              <tr><td>6</td><td>Smartphone</td><td>South</td><td>2024</td><td>3</td><td>7</td><td>14000.00</td></tr>
              <tr><td>7</td><td>Laptop</td><td>North</td><td>2024</td><td>3</td><td>8</td><td>20000.00</td></tr>
              <tr><td>8</td><td>Tablet</td><td>East</td><td>2024</td><td>4</td><td>10</td><td>9000.00</td></tr>
              <tr><td>9</td><td>Smartphone</td><td>West</td><td>2024</td><td>4</td><td>11</td><td>11000.00</td></tr>
              <tr><td>10</td><td>Laptop</td><td>South</td><td>2024</td><td>4</td><td>12</td><td>25000.00</td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <section>
        <h2 id="exercise-1">Alistirma 1: Toplama Fonksiyonlari</h2>

        <div class="exercise-box">
          <h4>Alistirma 1.1: Temel COUNT</h4>
          <p>orders tablosundaki toplam siparis sayisini sayiniz.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol1-1')">Cozumu Goster</button>
          <div id="sol1-1" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol1-1-code')">
              <pre class="sourceCode sql" id="sol1-1-code"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">AS</span> total_orders
<span class="kw">FROM</span> orders;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 1.2: COUNT(sutun) ve COUNT(*) Karsilastirmasi</h4>
          <p>Iki sorgu yazin: biri tum siparisleri sayan, digeri sadece kargolanan siparisleri
            (shipped_date NULL degil) sayan. Sonuclari karsilastirin.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol1-2')">Cozumu Goster</button>
          <div id="sol1-2" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol1-2-code')">
              <pre class="sourceCode sql" id="sol1-2-code"><code class="sourceCode sql"><span class="co">-- Tum siparisleri say</span>
<span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">AS</span> total_orders
<span class="kw">FROM</span> orders;

<span class="co">-- Sadece kargolanan siparisleri say (shipped_date NULL DEGIL)</span>
<span class="kw">SELECT</span> <span class="fu">COUNT</span>(shipped_date) <span class="kw">AS</span> shipped_orders
<span class="kw">FROM</span> orders;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 1.3: COUNT DISTINCT</h4>
          <p>Kac farkli musteri siparis vermis?</p>
          <button class="solution-toggle" onclick="toggleSolution('sol1-3')">Cozumu Goster</button>
          <div id="sol1-3" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol1-3-code')">
              <pre class="sourceCode sql" id="sol1-3-code"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> customer_id) <span class="kw">AS</span> unique_customers
<span class="kw">FROM</span> orders;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 1.4: SUM ve AVG</h4>
          <p>Sadece tamamlanan siparisler icin toplam geliri ve ortalama siparis degerini hesaplayin.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol1-4')">Cozumu Goster</button>
          <div id="sol1-4" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol1-4-code')">
              <pre class="sourceCode sql" id="sol1-4-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    <span class="fu">SUM</span>(total_amount) <span class="kw">AS</span> total_revenue,
    <span class="fu">AVG</span>(total_amount) <span class="kw">AS</span> avg_order_value
<span class="kw">FROM</span> orders
<span class="kw">WHERE</span> status = <span class="st">'delivered'</span>;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 1.5: MIN ve MAX</h4>
          <p>employees tablosundaki en dusuk ve en yuksek maaslari, ayrica en erken ve en gec ise alim
            tarihlerini bulun.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol1-5')">Cozumu Goster</button>
          <div id="sol1-5" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol1-5-code')">
              <pre class="sourceCode sql" id="sol1-5-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    <span class="fu">MIN</span>(salary) <span class="kw">AS</span> lowest_salary,
    <span class="fu">MAX</span>(salary) <span class="kw">AS</span> highest_salary,
    <span class="fu">MIN</span>(hire_date) <span class="kw">AS</span> earliest_hire,
    <span class="fu">MAX</span>(hire_date) <span class="kw">AS</span> latest_hire
<span class="kw">FROM</span> employees;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 1.6: Birden Fazla Toplama Fonksiyonunu Birlestirme</h4>
          <p>employees tablosu icin bir ozet raporu olusturun: toplam calisan sayisi, toplam maas gideri, ortalama
            maas, minimum maas ve maksimum maas gosterin.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol1-6')">Cozumu Goster</button>
          <div id="sol1-6" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol1-6-code')">
              <pre class="sourceCode sql" id="sol1-6-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    <span class="fu">COUNT</span>(*) <span class="kw">AS</span> total_employees,
    <span class="fu">SUM</span>(salary) <span class="kw">AS</span> total_salary_expense,
    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(salary), <span class="dv">2</span>) <span class="kw">AS</span> avg_salary,
    <span class="fu">MIN</span>(salary) <span class="kw">AS</span> min_salary,
    <span class="fu">MAX</span>(salary) <span class="kw">AS</span> max_salary
<span class="kw">FROM</span> employees;</code></pre>
            </div>
          </div>
        </div>
      </section>

      <section>
        <h2 id="exercise-2">Alistirma 2: GROUP BY</h2>

        <div class="concept-box">
          <h4>GROUP BY Kuralini Unutmayin</h4>
          <p>SELECT listesindeki toplanmamis her sutun <strong>mutlaka</strong> GROUP BY yan tumcesinde yer almalidir.</p>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 2.1: Temel Gruplama</h4>
          <p>Her departmandaki calisan sayisini sayiniz.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol2-1')">Cozumu Goster</button>
          <div id="sol2-1" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol2-1-code')">
              <pre class="sourceCode sql" id="sol2-1-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    department,
    <span class="fu">COUNT</span>(*) <span class="kw">AS</span> employee_count
<span class="kw">FROM</span> employees
<span class="kw">GROUP BY</span> department;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 2.2: Toplama Fonksiyonlari ile Gruplama</h4>
          <p>Her departman icin ortalama maasi hesaplayin. Ortalama maasa gore azalan sirada siralayin.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol2-2')">Cozumu Goster</button>
          <div id="sol2-2" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol2-2-code')">
              <pre class="sourceCode sql" id="sol2-2-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    department,
    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(salary), <span class="dv">2</span>) <span class="kw">AS</span> avg_salary
<span class="kw">FROM</span> employees
<span class="kw">GROUP BY</span> department
<span class="kw">ORDER BY</span> avg_salary <span class="kw">DESC</span>;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 2.3: Grup Basina Birden Fazla Toplama</h4>
          <p>Her departman icin calisan sayisini, toplam maasi, ortalama maasi, minimum maasi ve maksimum
            maasi gosterin.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol2-3')">Cozumu Goster</button>
          <div id="sol2-3" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol2-3-code')">
              <pre class="sourceCode sql" id="sol2-3-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    department,
    <span class="fu">COUNT</span>(*) <span class="kw">AS</span> num_employees,
    <span class="fu">SUM</span>(salary) <span class="kw">AS</span> total_salary,
    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(salary), <span class="dv">2</span>) <span class="kw">AS</span> avg_salary,
    <span class="fu">MIN</span>(salary) <span class="kw">AS</span> min_salary,
    <span class="fu">MAX</span>(salary) <span class="kw">AS</span> max_salary
<span class="kw">FROM</span> employees
<span class="kw">GROUP BY</span> department
<span class="kw">ORDER BY</span> total_salary <span class="kw">DESC</span>;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 2.4: Musteriye Gore Gruplama</h4>
          <p>Her musterinin harcadigi toplam tutari ve siparis sayisini bulun. Sadece tamamlanan siparisleri dikkate alin.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol2-4')">Cozumu Goster</button>
          <div id="sol2-4" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol2-4-code')">
              <pre class="sourceCode sql" id="sol2-4-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    customer_id,
    <span class="fu">COUNT</span>(*) <span class="kw">AS</span> num_orders,
    <span class="fu">SUM</span>(total_amount) <span class="kw">AS</span> total_spent
<span class="kw">FROM</span> orders
<span class="kw">WHERE</span> status = <span class="st">'delivered'</span>
<span class="kw">GROUP BY</span> customer_id
<span class="kw">ORDER BY</span> total_spent <span class="kw">DESC</span>;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 2.5: Birden Fazla Sutuna Gore Gruplama</h4>
          <p>sales_data tablosundan her bolgedeki her urun icin toplam satislari hesaplayin.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol2-5')">Cozumu Goster</button>
          <div id="sol2-5" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol2-5-code')">
              <pre class="sourceCode sql" id="sol2-5-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    product,
    region,
    <span class="fu">SUM</span>(sales) <span class="kw">AS</span> total_sales
<span class="kw">FROM</span> sales_data
<span class="kw">GROUP BY</span> product, region
<span class="kw">ORDER BY</span> product, total_sales <span class="kw">DESC</span>;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 2.6: Tarih Parcasina Gore Gruplama</h4>
          <p>2024 yilinin her ayinda verilen siparis sayisini sayiniz. Ayi almak icin EXTRACT kullanin.</p>
          <div class="hint-box">
            <strong>Ipucu:</strong> Ay numarasini almak icin EXTRACT(MONTH FROM order_date) kullanin.
          </div>
          <button class="solution-toggle" onclick="toggleSolution('sol2-6')">Cozumu Goster</button>
          <div id="sol2-6" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol2-6-code')">
              <pre class="sourceCode sql" id="sol2-6-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    <span class="fu">EXTRACT</span>(<span class="dt">MONTH</span> <span class="kw">FROM</span> order_date) <span class="kw">AS</span> order_month,
    <span class="fu">COUNT</span>(*) <span class="kw">AS</span> num_orders,
    <span class="fu">SUM</span>(total_amount) <span class="kw">AS</span> monthly_revenue
<span class="kw">FROM</span> orders
<span class="kw">WHERE</span> <span class="fu">EXTRACT</span>(<span class="dt">YEAR</span> <span class="kw">FROM</span> order_date) = <span class="dv">2024</span>
<span class="kw">GROUP BY</span> <span class="fu">EXTRACT</span>(<span class="dt">MONTH</span> <span class="kw">FROM</span> order_date)
<span class="kw">ORDER BY</span> order_month;</code></pre>
            </div>
          </div>
        </div>
      </section>

      <section>
        <h2 id="exercise-3">Alistirma 3: HAVING Yan Tumcesi</h2>

        <div class="concept-box">
          <h4>WHERE ve HAVING Karsilastirmasi</h4>
          <div class="comparison-table">
            <table>
              <tr>
                <th>WHERE</th>
                <th>HAVING</th>
              </tr>
              <tr>
                <td>Gruplama ONCESINDE tek tek satirlari filtreler</td>
                <td>Gruplama SONRASINDA gruplari filtreler</td>
              </tr>
              <tr>
                <td>Toplama fonksiyonlari kullanilamaz</td>
                <td>Genellikle toplama fonksiyonlari kullanir</td>
              </tr>
              <tr>
                <td>Once islenir</td>
                <td>GROUP BY'dan sonra islenir</td>
              </tr>
            </table>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 3.1: Temel HAVING</h4>
          <p>3'ten fazla calisani olan departmanlari bulun.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol3-1')">Cozumu Goster</button>
          <div id="sol3-1" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol3-1-code')">
              <pre class="sourceCode sql" id="sol3-1-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    department,
    <span class="fu">COUNT</span>(*) <span class="kw">AS</span> employee_count
<span class="kw">FROM</span> employees
<span class="kw">GROUP BY</span> department
<span class="kw">HAVING</span> <span class="fu">COUNT</span>(*) > <span class="dv">3</span>;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 3.2: Ortalama ile HAVING</h4>
          <p>Ortalama maasi 70.000$'dan fazla olan departmanlari bulun.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol3-2')">Cozumu Goster</button>
          <div id="sol3-2" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol3-2-code')">
              <pre class="sourceCode sql" id="sol3-2-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    department,
    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(salary), <span class="dv">2</span>) <span class="kw">AS</span> avg_salary
<span class="kw">FROM</span> employees
<span class="kw">GROUP BY</span> department
<span class="kw">HAVING</span> <span class="fu">AVG</span>(salary) > <span class="dv">70000</span>;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 3.3: Yuksek Degerli Musterileri Bulma</h4>
          <p>2'den fazla siparis veren ve toplam harcamasi 500$'in uzerinde olan musterileri bulun.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol3-3')">Cozumu Goster</button>
          <div id="sol3-3" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol3-3-code')">
              <pre class="sourceCode sql" id="sol3-3-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    customer_id,
    <span class="fu">COUNT</span>(*) <span class="kw">AS</span> num_orders,
    <span class="fu">SUM</span>(total_amount) <span class="kw">AS</span> total_spent
<span class="kw">FROM</span> orders
<span class="kw">GROUP BY</span> customer_id
<span class="kw">HAVING</span> <span class="fu">COUNT</span>(*) > <span class="dv">2</span> <span class="kw">AND</span> <span class="fu">SUM</span>(total_amount) > <span class="dv">500</span>;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 3.4: WHERE ve HAVING'i Birlestirme</h4>
          <p>Toplam satisi 30.000$'in uzerinde olan urunleri bulun, ancak sadece C1 ve C2'deki (1. ve 2. ceyrekler) satislari dikkate alin.</p>
          <div class="hint-box">
            <strong>Ipucu:</strong> Once ceyrege gore filtrelemek icin WHERE kullanin, sonra toplam satisa gore filtrelemek icin HAVING kullanin.
          </div>
          <button class="solution-toggle" onclick="toggleSolution('sol3-4')">Cozumu Goster</button>
          <div id="sol3-4" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol3-4-code')">
              <pre class="sourceCode sql" id="sol3-4-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    product,
    <span class="fu">SUM</span>(sales) <span class="kw">AS</span> total_sales
<span class="kw">FROM</span> sales_data
<span class="kw">WHERE</span> quarter <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>)  <span class="co">-- Gruplama ONCESINDE satirlari filtrele</span>
<span class="kw">GROUP BY</span> product
<span class="kw">HAVING</span> <span class="fu">SUM</span>(sales) > <span class="dv">30000</span>;  <span class="co">-- Gruplama SONRASINDA gruplari filtrele</span></code></pre>
            </div>
          </div>
        </div>
      </section>

      <section>
        <h2 id="exercise-4">Alistirma 4: Pencere Fonksiyonlari</h2>

        <div class="concept-box">
          <h4>Pencere Fonksiyonlari ve GROUP BY Karsilastirmasi</h4>
          <p>Pencere fonksiyonlari satirlar uzerinde hesaplamalar yapar ancak GROUP BY gibi <strong>satirlari daraltmaz</strong>.
            Her satir kimligini korurken toplanmis veya siralanmis degerlere erisebilir.</p>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 4.1: ROW_NUMBER</h4>
          <p>Her calisana maasa gore (en yuksekten baslayarak) bir satir numarasi atayin.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol4-1')">Cozumu Goster</button>
          <div id="sol4-1" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol4-1-code')">
              <pre class="sourceCode sql" id="sol4-1-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    first_name || ' ' || last_name AS employee_name,
    department,
    salary,
    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">ORDER BY</span> salary <span class="kw">DESC</span>) <span class="kw">AS</span> salary_rank
<span class="kw">FROM</span> employees;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 4.2: PARTITION BY ile ROW_NUMBER</h4>
          <p>Her departman icinde calisanlari maasa gore siralayin. Departman, isim, maas ve sirayi gosterin.</p>
          <div class="hint-box">
            <strong>Ipucu:</strong> Her departman icin numaralandirmayi yeniden baslatmak icin PARTITION BY department kullanin.
          </div>
          <button class="solution-toggle" onclick="toggleSolution('sol4-2')">Cozumu Goster</button>
          <div id="sol4-2" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol4-2-code')">
              <pre class="sourceCode sql" id="sol4-2-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    department,
    first_name || ' ' || last_name AS employee_name,
    salary,
    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (
        <span class="kw">PARTITION BY</span> department
        <span class="kw">ORDER BY</span> salary <span class="kw">DESC</span>
    ) <span class="kw">AS</span> dept_salary_rank
<span class="kw">FROM</span> employees
<span class="kw">ORDER BY</span> department, dept_salary_rank;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 4.3: RANK ve DENSE_RANK Karsilastirmasi</h4>
          <p>Calisan maaslari uzerinde ROW_NUMBER, RANK ve DENSE_RANK fonksiyonlarini karsilastirin (gercek veride esitlikler olabilir).</p>
          <button class="solution-toggle" onclick="toggleSolution('sol4-3')">Cozumu Goster</button>
          <div id="sol4-3" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol4-3-code')">
              <pre class="sourceCode sql" id="sol4-3-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    first_name || ' ' || last_name AS employee_name,
    salary,
    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">ORDER BY</span> salary <span class="kw">DESC</span>) <span class="kw">AS</span> row_num,
    <span class="fu">RANK</span>() <span class="kw">OVER</span> (<span class="kw">ORDER BY</span> salary <span class="kw">DESC</span>) <span class="kw">AS</span> rank_num,
    <span class="fu">DENSE_RANK</span>() <span class="kw">OVER</span> (<span class="kw">ORDER BY</span> salary <span class="kw">DESC</span>) <span class="kw">AS</span> dense_rank_num
<span class="kw">FROM</span> employees;</code></pre>
            </div>
            <div class="info-box">
              <strong>Fark:</strong>
              <ul>
                <li><strong>ROW_NUMBER:</strong> Her zaman benzersiz (1, 2, 3, 4...)</li>
                <li><strong>RANK:</strong> Esitler ayni sirayi alir, sonra atlar (1, 2, 2, 4...)</li>
                <li><strong>DENSE_RANK:</strong> Esitler ayni sirayi alir, atlamaz (1, 2, 2, 3...)</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 4.4: SUM ile Kumulatif Toplam</h4>
          <p>Siparis tarihine gore sirali olarak siparis tutarlarinin kumulatif toplamini hesaplayin.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol4-4')">Cozumu Goster</button>
          <div id="sol4-4" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol4-4-code')">
              <pre class="sourceCode sql" id="sol4-4-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    id AS order_id,
    order_date,
    total_amount,
    <span class="fu">SUM</span>(total_amount) <span class="kw">OVER</span> (
        <span class="kw">ORDER BY</span> order_date
        <span class="kw">ROWS UNBOUNDED PRECEDING</span>
    ) <span class="kw">AS</span> running_total
<span class="kw">FROM</span> orders
<span class="kw">ORDER BY</span> order_date;</code></pre>
            </div>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 4.5: LAG Fonksiyonu - Onceki Satirla Karsilastirma</h4>
          <p>Her siparisi onceki sipariszin tutariyla gostererek ardisik siparisler arasindaki farki hesaplayin.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol4-5')">Cozumu Goster</button>
          <div id="sol4-5" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol4-5-code')">
              <pre class="sourceCode sql" id="sol4-5-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    id AS order_id,
    order_date,
    total_amount,
    <span class="fu">LAG</span>(total_amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER BY</span> order_date) <span class="kw">AS</span> prev_total_amount,
    total_amount - <span class="fu">LAG</span>(total_amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER BY</span> order_date) <span class="kw">AS</span> difference
<span class="kw">FROM</span> orders
<span class="kw">ORDER BY</span> order_date;</code></pre>
            </div>
            <p><strong>Not:</strong> LAG(sutun, offset, varsayilan) - offset kac satir geriye gidilecegi (varsayilan 1), varsayilan deger ilk satir icin kullanilir.</p>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 4.6: Toplamin Yuzdesini Hesaplama</h4>
          <p>Her sipariszin tum siparislerin toplamina olan yuzdesel katkilisini hesaplayin.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol4-6')">Cozumu Goster</button>
          <div id="sol4-6" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol4-6-code')">
              <pre class="sourceCode sql" id="sol4-6-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    id AS order_id,
    total_amount,
    <span class="fu">SUM</span>(total_amount) <span class="kw">OVER</span> () <span class="kw">AS</span> grand_total,
    <span class="fu">ROUND</span>(
        (total_amount / <span class="fu">SUM</span>(total_amount) <span class="kw">OVER</span> ()) * <span class="dv">100</span>,
        <span class="dv">2</span>
    ) <span class="kw">AS</span> percentage_of_total
<span class="kw">FROM</span> orders;</code></pre>
            </div>
            <p><strong>Not:</strong> Bos OVER() pencere fonksiyonunun tum sonuc kumesini kapsamasi anlamina gelir.</p>
          </div>
        </div>

        <div class="exercise-box">
          <h4>Alistirma 4.7: Hareketli Ortalama</h4>
          <p>sales_data tablosundan aya gore sirali olarak 3 satirlik hareketli ortalama hesaplayin.</p>
          <button class="solution-toggle" onclick="toggleSolution('sol4-7')">Cozumu Goster</button>
          <div id="sol4-7" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('sol4-7-code')">
              <pre class="sourceCode sql" id="sol4-7-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    month,
    product,
    sales,
    <span class="fu">ROUND</span>(
        <span class="fu">AVG</span>(sales) <span class="kw">OVER</span> (
            <span class="kw">ORDER BY</span> month
            <span class="kw">ROWS BETWEEN</span> <span class="dv">2</span> <span class="kw">PRECEDING AND CURRENT ROW</span>
        ),
        <span class="dv">2</span>
    ) <span class="kw">AS</span> moving_avg_3
<span class="kw">FROM</span> sales_data
<span class="kw">ORDER BY</span> month;</code></pre>
            </div>
          </div>
        </div>
      </section>

      <section>
        <h2 id="challenge-exercises">Meydan Okuma Alistirmalari</h2>

        <div class="challenge-box">
          <h4>Meydan Okuma 1: Departman Maas Raporu</h4>
          <p>Her calisan icin kapsamli bir maas raporu olusturun: isim, departman, maas, departman
            ortalama maasi ve departman ortalamasinin ne kadar ustunde veya altinda kazandigi.</p>
          <button class="solution-toggle" onclick="toggleSolution('chal1')">Cozumu Goster</button>
          <div id="chal1" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('chal1-code')">
              <pre class="sourceCode sql" id="chal1-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    first_name || ' ' || last_name AS employee_name,
    department,
    salary,
    <span class="fu">ROUND</span>(<span class="fu">AVG</span>(salary) <span class="kw">OVER</span> (<span class="kw">PARTITION BY</span> department), <span class="dv">2</span>) <span class="kw">AS</span> dept_avg_salary,
    <span class="fu">ROUND</span>(salary - <span class="fu">AVG</span>(salary) <span class="kw">OVER</span> (<span class="kw">PARTITION BY</span> department), <span class="dv">2</span>) <span class="kw">AS</span> diff_from_avg
<span class="kw">FROM</span> employees
<span class="kw">ORDER BY</span> department, salary <span class="kw">DESC</span>;</code></pre>
            </div>
          </div>
        </div>

        <div class="challenge-box">
          <h4>Meydan Okuma 2: Departmandaki En Iyi Performans</h4>
          <p>Her departmandaki en yuksek maasli calisani bulun. Departman, calisan adi ve maasi gosterin.</p>
          <div class="hint-box">
            <strong>Ipucu:</strong> PARTITION BY ile ROW_NUMBER kullanin, sonra rank = 1 olanlari filtreleyin.
          </div>
          <button class="solution-toggle" onclick="toggleSolution('chal2')">Cozumu Goster</button>
          <div id="chal2" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('chal2-code')">
              <pre class="sourceCode sql" id="chal2-code"><code class="sourceCode sql"><span class="kw">SELECT</span> department, employee_name, salary
<span class="kw">FROM</span> (
    <span class="kw">SELECT</span>
        department,
        first_name || <span class="st">' '</span> || last_name <span class="kw">AS</span> employee_name,
        salary,
        <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (
            <span class="kw">PARTITION BY</span> department
            <span class="kw">ORDER BY</span> salary <span class="kw">DESC</span>
        ) <span class="kw">AS</span> rn
    <span class="kw">FROM</span> employees
) ranked
<span class="kw">WHERE</span> rn = <span class="dv">1</span>;</code></pre>
            </div>
          </div>
        </div>

        <div class="challenge-box">
          <h4>Meydan Okuma 3: Satis Buyume Analizi</h4>
          <p>sales_data'daki her ay icin toplam satislari, onceki ayin satislarini ve onceki aya gore yuzdesel buyumeyi gosterin.</p>
          <button class="solution-toggle" onclick="toggleSolution('chal3')">Cozumu Goster</button>
          <div id="chal3" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('chal3-code')">
              <pre class="sourceCode sql" id="chal3-code"><code class="sourceCode sql"><span class="kw">WITH</span> monthly_sales <span class="kw">AS</span> (
    <span class="kw">SELECT</span>
        month,
        <span class="fu">SUM</span>(sales) <span class="kw">AS</span> total_sales
    <span class="kw">FROM</span> sales_data
    <span class="kw">GROUP BY</span> month
)
<span class="kw">SELECT</span>
    month,
    total_sales,
    <span class="fu">LAG</span>(total_sales) <span class="kw">OVER</span> (<span class="kw">ORDER BY</span> month) <span class="kw">AS</span> prev_month_sales,
    <span class="fu">ROUND</span>(
        (total_sales - <span class="fu">LAG</span>(total_sales) <span class="kw">OVER</span> (<span class="kw">ORDER BY</span> month)) /
        <span class="fu">LAG</span>(total_sales) <span class="kw">OVER</span> (<span class="kw">ORDER BY</span> month) * <span class="dv">100</span>,
        <span class="dv">2</span>
    ) <span class="kw">AS</span> growth_percentage
<span class="kw">FROM</span> monthly_sales
<span class="kw">ORDER BY</span> month;</code></pre>
            </div>
          </div>
        </div>

        <div class="challenge-box">
          <h4>Meydan Okuma 4: Bolgeye Gore Kumulatif Satislar</h4>
          <p>Her bolge icin ayri ayri aya gore sirali kumulatif (artan) satislari gosterin.</p>
          <button class="solution-toggle" onclick="toggleSolution('chal4')">Cozumu Goster</button>
          <div id="chal4" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('chal4-code')">
              <pre class="sourceCode sql" id="chal4-code"><code class="sourceCode sql"><span class="kw">SELECT</span>
    region,
    month,
    product,
    sales,
    <span class="fu">SUM</span>(sales) <span class="kw">OVER</span> (
        <span class="kw">PARTITION BY</span> region
        <span class="kw">ORDER BY</span> month
        <span class="kw">ROWS UNBOUNDED PRECEDING</span>
    ) <span class="kw">AS</span> cumulative_region_sales
<span class="kw">FROM</span> sales_data
<span class="kw">ORDER BY</span> region, month;</code></pre>
            </div>
          </div>
        </div>

        <div class="challenge-box">
          <h4>Meydan Okuma 5: Musteri Siparis Sıklığı Analizi</h4>
          <p>Musterileri siparis sayilarina gore kategorize edin: 'Sık' (3+ siparis), 'Duzenli' (2 siparis), 'Yeni' (1
            siparis). Her kategorideki musteri sayisini gosterin.</p>
          <button class="solution-toggle" onclick="toggleSolution('chal5')">Cozumu Goster</button>
          <div id="chal5" class="solution-content">
            <div class="sourceCode" onclick="CopyToClipboard('chal5-code')">
              <pre class="sourceCode sql" id="chal5-code"><code class="sourceCode sql"><span class="kw">WITH</span> customer_orders <span class="kw">AS</span> (
    <span class="kw">SELECT</span>
        customer_id,
        <span class="fu">COUNT</span>(*) <span class="kw">AS</span> order_count,
        <span class="kw">CASE</span>
            <span class="kw">WHEN</span> <span class="fu">COUNT</span>(*) >= <span class="dv">3</span> <span class="kw">THEN</span> <span class="st">'Sık'</span>
            <span class="kw">WHEN</span> <span class="fu">COUNT</span>(*) = <span class="dv">2</span> <span class="kw">THEN</span> <span class="st">'Duzenli'</span>
            <span class="kw">ELSE</span> <span class="st">'Yeni'</span>
        <span class="kw">END</span> <span class="kw">AS</span> customer_category
    <span class="kw">FROM</span> orders
    <span class="kw">GROUP BY</span> customer_id
)
<span class="kw">SELECT</span>
    customer_category,
    <span class="fu">COUNT</span>(*) <span class="kw">AS</span> num_customers
<span class="kw">FROM</span> customer_orders
<span class="kw">GROUP BY</span> customer_category
<span class="kw">ORDER BY</span> num_customers <span class="kw">DESC</span>;</code></pre>
            </div>
          </div>
        </div>
      </section>

      <section>
        <h2 id="summary">Onemli Cikarimlar</h2>
        <ul>
          <li><strong>Toplama Fonksiyonlari</strong>: COUNT, SUM, AVG, MIN, MAX satir kumeleri uzerinde islem yaparak tekil degerler uretir</li>
          <li><strong>COUNT(*) ve COUNT(sutun)</strong>: COUNT(*) tum satirlari sayar; COUNT(sutun) NULL olmayan degerleri sayar</li>
          <li><strong>GROUP BY</strong>: Ayni degerlere sahip satirlari gruplar; toplanmamis tum SELECT sutunlari GROUP BY'da olmalidir</li>
          <li><strong>HAVING</strong>: Toplamadan sonra gruplari filtreler; toplama sonuclari uzerindeki kosullar icin kullanilir</li>
          <li><strong>WHERE ve HAVING</strong>: WHERE gruplama oncesinde satirlari filtreler; HAVING gruplama sonrasinda gruplari filtreler</li>
          <li><strong>Pencere Fonksiyonlari</strong>: Iliskili satirlar uzerinde satirlari daraltmadan hesaplamalar yapar</li>
          <li><strong>PARTITION BY</strong>: Satirlari pencere fonksiyonu hesaplamalari icin bolumlere ayirir</li>
          <li><strong>ROW_NUMBER, RANK, DENSE_RANK</strong>: Esitlikler icin farkli siralama davranislari</li>
          <li><strong>LAG/LEAD</strong>: Karsilastirmalar icin onceki/sonraki satir degerlerine erisim</li>
          <li><strong>Cerceve Yan Tumcesi</strong>: Toplama pencere fonksiyonlari icin satir penceresini tanimlar (ornegin kumulatif toplamlar)</li>
        </ul>

        <div class="back-link" style="margin-top: 30px;">
          <a href="05_advanced_select_techniques_tr.html">&larr; Gelismis SELECT Tekniklerine Geri Don</a>
        </div>
      </section>

    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

  <script src="../static/script.js"></script>

  <script>
    function toggleSolution(id) {
      var element = document.getElementById(id);
      if (element.classList.contains('show')) {
        element.classList.remove('show');
        event.target.textContent = 'Cozumu Goster';
      } else {
        element.classList.add('show');
        event.target.textContent = 'Cozumu Gizle';
      }
    }
  </script>

</body>

</html>
